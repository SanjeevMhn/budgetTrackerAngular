<section class="wallet-container h-full">
  <div
    class="wrapper pt-[3.5rem] flex flex-col gap-y-[5.5rem] isolate pt-[1.5rem] flex flex-col gap-[2rem] relative after:content-[''] after:w-full after:h-[20rem] after:absolute after:rounded-b-[4rem] after:bg-linear-to-br after:from-[#429690] after:to-[#2A7C76] after:z-[-1]"
  >
    <div class="top-section flex items-center justify-between text-white">
      <button
        type="button"
        class="w-[2.5rem] h-[2.5rem] flex items-center justify-center cursor-pointer"
      >
        <lucide-angular
          [img]="backButtonIcon"
          class="w-full h-full"
        ></lucide-angular>
      </button>
      <h2 class="title-text text-[2rem]">Budgeting</h2>
      <button
        type="button"
        class="w-[2.5rem] h-[2.5rem] flex items-center justify-center"
      >
        <lucide-angular [img]="bellIcon"></lucide-angular>
      </button>
    </div>
    <div
      class="wallet-details rounded-[3rem] rounded-tr-[2rem] bg-white p-[2rem_1.5rem] shadow-lg relative flex items-center flex-col"
      [class]="budgets.getBudgets().length == 0 ? 'gap-[1.5rem]' : ''"
    >
      @if(budgets.getBudgets().length == 0){
      <span
        class="icon-container w-[45%] aspect-square flex items-center justify-center rounded-full bg-[#e9c46a]"
      >
        <lucide-angular
          [img]="notebook"
          class="w-[75%] h-[75%] text-white flex items-center justify-center"
        ></lucide-angular>
      </span>
      <h2 class="text-[1.8rem] text-center">No budgets set.</h2>
      <button
        class="rounded-full p-[1.5rem] bg-[#438883] text-white text-[1.6rem] text-center w-full cursor-pointer"
        (click)="onOpenBudgetDialog()"
      >
        Add Budget
      </button>
      }@else {
      <header class="title-header flex justify-between items-center w-full">
        <h2 class="list-title text-[1.8rem] font-medium">Budget List</h2>
        <button
          class="rounded-md p-[1rem] border-2 border-[#438883] text-[#438883] text-center cursor-pointer text-[1.5rem] font-medium"
          (click)="onOpenBudgetDialog()"
        >
          Set Budget
          <!-- <lucide-angular [img]="plusIcon"></lucide-angular> -->
        </button>
      </header>
      <ul class="budgets-list w-full">
        @for(budget of budgets.getBudgets(); track budget.id){
        <li
          class="item grid grid-cols-[2rem_1fr_1fr] gap-x-[1rem] gap-y-[0.75rem] first: border-b-2 border-neutral-200 py-[1.5rem]"
        >
          <h2 class="budget-name text-[1.65rem] text-[#438883] row-1 col-[1/-1] flex items-end font-medium">
            {{budget.name}}
          </h2>
          <p
            class="budget-duration capitalize text-[1.4rem] flex row-2 col-3 gap-[0.5rem] flex justify-end"
          >
            ({{budget.date | date:"MMM, yyyy"}})
          </p>
          <p class="col-3 row-3 text-end text-[1.4rem] text-neutral-700 flex items-end justify-end">
            {{ getTotalPercentageUsed(budget.total_spent, budget.limit)}}% used
          </p>
          <div class="budget-amount font-medium text-[1.4rem] row-2 col-[1/span_2]">
            <span class="font-medium">Limit: </span> Rs.{{ budget.limit}}
          </div>
          <div class="budget-amount font-medium text-[1.4rem] row-3 col-[1/span_2]">
            <span class="font-medium">Remaining: </span> Rs.{{
            getRemaining(budget.total_spent, budget.limit)}}
          </div>
          <button
            type="button"
            class="cursor-pointer col-3 row-1 flex justify-end"
            [matMenuTriggerFor]="menu"
          >
            <span
              class="icon-container w-[2.5rem] h-[2.5rem] flex items-center justify-center"
            >
              <lucide-angular [img]="ellipsesIcon"></lucide-angular>
            </span>
          </button>
          <mat-menu #menu="matMenu" class="bg-white! rounded-xl!">
            <button
              type="button"
              mat-menu-item
              class="p-[0.5rem_1rem] text-[1.8rem]! cursor-pointer bg-white hover:bg-neutral-300"
              (click)="onEdit(budget)"
            >
              Edit Budget
            </button>
            <button
              type="button"
              mat-menu-item
              class="text-red-700! p-[0.5rem_1rem] text-[1.8rem]! cursor-pointer bg-white hover:bg-neutral-300"
              (click)="onDelete(budget.id)"
            >
              Delete Budget
            </button>
          </mat-menu>
          <div
            class="progress-bar-container row-4 col-[1/-1] h-[1.2rem] border-2 border-[#e9c46a] rounded-lg overflow-hidden"
          >
            <div
              class="progress-data rounded-lg h-full bg-[#438883]"
              [style.width]="`${getTotalPercentageUsed(budget.total_spent, budget.limit)}%`"
            ></div>
          </div>
        </li>
        }
      </ul>
      <!-- <app-transactions-list
        [transactions]="transactions.expensesByMonth()"
        class="w-full"
      /> -->
      }
    </div>
  </div>
</section>
